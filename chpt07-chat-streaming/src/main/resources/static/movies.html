<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Movies List</title>
    <script src="https://unpkg.com/htmx.org"></script>
    <style>
        .movie { border-bottom: 1px solid #ccc; padding: 10px 0; }
    </style>
</head>
<script>
    const eventSource = new EventSource('/movies/stream');
    eventSource.onmessage = function(event) {
        // Append each movie to the movie container
        const movieHtml = event.data; // The HTML content from the event
        console.log(movieHtml);
        document.getElementById('movie-container').insertAdjacentHTML('beforeend', movieHtml);
    };

    eventSource.onerror = function(event) {
        console.error("EventSource failed: ", event);
        eventSource.close();
    };
</script>
<body>
    <h1>Movies</h1>
<!--    <div id="movie-container" hx-get="/movies/stream"-->
<!--         hx-trigger="load"-->
<!--         hx-swap="beforeend"-->
<!--         hx-sse="true"-->
<!--         hx-target="#movie-container">-->
<!--    </div>-->
    <div id="movie-container">

    </div>

    <a href="/movies/stream" >
        Load Movies
    </a>
</body>
</html>
