package com.testehan.springai.gemini.controller;

import org.springframework.ai.chat.messages.UserMessage;
import org.springframework.ai.chat.model.ChatResponse;
import org.springframework.ai.chat.prompt.Prompt;
import org.springframework.ai.vertexai.gemini.VertexAiGeminiChatModel;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;
import reactor.core.publisher.Flux;

import java.util.Map;

@RestController
public class ChatController {

    private final VertexAiGeminiChatModel chatModel;

    @Autowired
    public ChatController(VertexAiGeminiChatModel chatModel) {
        this.chatModel = chatModel;
    }

    @GetMapping("/ai/generate")
    public Map generate(@RequestParam(value = "message", defaultValue = "Tell me a joke") String message) {
        return Map.of("generation", chatModel.call(message));
    }

    @GetMapping("/ai/generateStream")
    public Flux<ChatResponse> generateStream(@RequestParam(value = "message", defaultValue = "Tell me a joke") String message) {
        Prompt prompt = new Prompt(new UserMessage(message));
        return chatModel.stream(prompt);
    }

    @GetMapping("/ai/apartments")
    public Map apartments(@RequestParam(value = "message", defaultValue = "Tell me a joke") String message) {
        var ap1 = "The apartment called \"1 room\" is located in the city Cluj-Napoca, area or neighbourhood Andrei Muresanu. I rent a detached 1-room apartment in Andrei Muresanu, Alverna street no. 42, 1st floor, block after 2010, superb view of the city. The apartment is completely finished, furnished and equipped.It is located extremely close to the means of transport, taxi station and shops, with quick and easy access to the city center.The apartment has a usable area of \u200B\u200B42 sq.m., a 5 sq.m. balcony, being equipped with an intercom, central heating system, double-glazed windows, laminate flooring, floor tiles, tiles, washable, wooden doors, cable TV + WI FI internet, FRANKE refrigerator combination, electric oven, HANSA gas stove and hood, SAMSUNG microwave oven, JVC SMART LED TV, washing machine, vacuum cleaner, etc.It has a surface of 42 square meters.The price is 450 euro. Number of rooms is 1. Located at floor 1. Additional keywords for this apartment are []. Description of provided images: This inviting living room features a cozy sofa with floral-patterned cushions, complemented by a wooden coffee table atop a plush area rug. The space is filled with natural light from large windows dressed with elegant curtains, offering a bright and airy atmosphere. The light wood flooring adds warmth and style, creating a comfortable and welcoming environment perfect for relaxation and gatherings.This spacious living room features a modern entertainment center with ample storage, showcasing a sleek design in natural wood and black accents. The shelving and cabinets provide both functionality and style. The room is enhanced by light wooden flooring and neutral walls, offering a welcoming and versatile space. Ideal for relaxation and entertainment, this area is perfect for creating a cozy and inviting atmosphere.This cozy kitchen features modern appliances and ample cabinetry in a compact layout. The light wood finishes and large window allow for plenty of natural light, creating a welcoming and functional space. Ideal for both cooking and entertaining, this kitchen offers a practical design with a built-in oven, stovetop, and efficient storage solutions. The sleek flooring adds a touch of elegance, completing the room's contemporary aesthetic.This bathroom features a modern design with beige tiled walls and a sleek white vanity. It includes a toilet, a washing machine for added convenience, and a large illuminated mirror above the sink. The space is well-lit and functional, ideal for both daily routines and relaxing moments. The bathroom's layout is both practical and aesthetically pleasing, offering a clean and comfortable environment.This bathroom features a classic design with beige tiled walls and floor, offering a clean and functional space. It includes a bathtub with a handheld showerhead, a white shower curtain with a decorative pattern, and a standard toilet. The wooden door adds a warm touch to the overall aesthetic, making it a cozy and practical area for daily use.";
        var ap2 = "The apartment called \"Grigorescu 3 rooms la 650 euro\" is located in the city Cluj-Napoca, area or neighbourhood Grigorescu. I rent a 4-room apartment in the Grigorescu district, Donath street area. The house is located on the 3rd floor out of 4. The usable area of \u200B\u200Bthe apartment is 78 sqm plus 2 balconies. The apartment has: - 3 bedrooms; - 1 large living room at the entrance; - 1 kitchen; - 2 bathrooms. - 2 balconies The apartment is fully finished , furnished and equipped:- heating plant- washing machine- gas oven- refrigerator- microwave oven- television- cable internet- solid wood parquet- PVC thermal insulating windows- tiles and tiles in the kitchen- tiles and tiles in the bathroom - wooden interior doors - metal entrance doorIt has a surface of 78 square meters.The price is 650 euro. Number of rooms is 4. Located at floor 4. Additional keywords for this apartment are []. Description of provided images: This cozy living room features a minimalist design with two comfortable armchairs, a wooden coffee table, and a matching sideboard. The room is decorated with geometric-patterned rugs and wall art, creating a welcoming atmosphere. A large window with sheer curtains allows ample natural light, enhancing the warm tones of the wooden flooring. Ideal for relaxation or entertaining guests.A cozy living room featuring a patterned area rug on a wooden floor, a vintage floral sofa, and a small wooden table with two matching chairs. The room is well-lit with natural light from a large window covered by sheer curtains, creating a warm and inviting atmosphere.Cozy single room featuring a comfortable bed, a wooden desk with a lamp, and a chair, perfect for study or work. The room is well-lit with natural light from the window, which is adorned with sheer curtains. A large wardrobe provides ample storage space. The warm wooden flooring and a decorative rug add to the room's inviting atmosphere, making it an ideal space for relaxation and productivity.Cozy room featuring a single bed with a colorful quilt, a wooden table, and a vintage cabinet. The room is illuminated by natural light through large windows with sheer golden curtains. The herringbone parquet flooring adds a classic touch, complemented by a patterned area rug. A glass door leads to a balcony, providing an outdoor view.This cozy bathroom features green tile flooring and walls, providing a fresh and clean aesthetic. It includes a compact washing machine, a white pedestal sink, a wall-mounted mirror with lighting, and a bathtub with a handheld shower. The small window allows natural light to brighten the space, enhancing its inviting atmosphere. The layout optimizes functionality, making it ideal for small apartments or studios.This cozy bathroom features a classic white tile design with charming floral accents. It includes a bathtub with a handheld shower, a compact shelving unit for storage, and a standard toilet. The space is well-lit and functional, ideal for daily use. A small window provides natural light, enhancing the room's inviting atmosphere. Perfect for those seeking a simple yet practical bathroom setup.This cozy kitchen features a classic design with a window providing natural light. It includes a gas stove, oven, and ample counter space for meal preparation. A small dining table fits comfortably, perfect for casual meals. The tiled flooring and radiator add warmth and functionality, while the wooden accents contribute to a homely atmosphere. Ideal for those seeking a practical and inviting cooking space in their home.The apartment called \"Grigorescu 3 rooms la 650 euro\" is located in the city Cluj-Napoca, area or neighbourhood Grigorescu. I rent a 4-room apartment in the Grigorescu district, Donath street area. The house is located on the 3rd floor out of 4. The usable area of \u200B\u200Bthe apartment is 78 sqm plus 2 balconies. The apartment has: - 3 bedrooms; - 1 large living room at the entrance; - 1 kitchen; - 2 bathrooms. - 2 balconies The apartment is fully finished , furnished and equipped:- heating plant- washing machine- gas oven- refrigerator- microwave oven- television- cable internet- solid wood parquet- PVC thermal insulating windows- tiles and tiles in the kitchen- tiles and tiles in the bathroom - wooden interior doors - metal entrance doorIt has a surface of 78 square meters.The price is 650 euro. Number of rooms is 4. Located at floor 4. Additional keywords for this apartment are []. Description of provided images: This cozy living room features a minimalist design with two comfortable armchairs, a wooden coffee table, and a matching sideboard. The room is decorated with geometric-patterned rugs and wall art, creating a welcoming atmosphere. A large window with sheer curtains allows ample natural light, enhancing the warm tones of the wooden flooring. Ideal for relaxation or entertaining guests.A cozy living room featuring a patterned area rug on a wooden floor, a vintage floral sofa, and a small wooden table with two matching chairs. The room is well-lit with natural light from a large window covered by sheer curtains, creating a warm and inviting atmosphere.Cozy single room featuring a comfortable bed, a wooden desk with a lamp, and a chair, perfect for study or work. The room is well-lit with natural light from the window, which is adorned with sheer curtains. A large wardrobe provides ample storage space. The warm wooden flooring and a decorative rug add to the room's inviting atmosphere, making it an ideal space for relaxation and productivity.Cozy room featuring a single bed with a colorful quilt, a wooden table, and a vintage cabinet. The room is illuminated by natural light through large windows with sheer golden curtains. The herringbone parquet flooring adds a classic touch, complemented by a patterned area rug. A glass door leads to a balcony, providing an outdoor view.This cozy bathroom features green tile flooring and walls, providing a fresh and clean aesthetic. It includes a compact washing machine, a white pedestal sink, a wall-mounted mirror with lighting, and a bathtub with a handheld shower. The small window allows natural light to brighten the space, enhancing its inviting atmosphere. The layout optimizes functionality, making it ideal for small apartments or studios.This cozy bathroom features a classic white tile design with charming floral accents. It includes a bathtub with a handheld shower, a compact shelving unit for storage, and a standard toilet. The space is well-lit and functional, ideal for daily use. A small window provides natural light, enhancing the room's inviting atmosphere. Perfect for those seeking a simple yet practical bathroom setup.This cozy kitchen features a classic design with a window providing natural light. It includes a gas stove, oven, and ample counter space for meal preparation. A small dining table fits comfortably, perfect for casual meals. The tiled flooring and radiator add warmth and functionality, while the wooden accents contribute to a homely atmosphere. Ideal for those seeking a practical and inviting cooking space in their home.";
        var ap3 = "The apartment called \"Buna Ziua 3 rooms 690 €\" is located in the city Cluj-Napoca, area or neighbourhood Buna Ziua . 3-room apartment for rent in the Bună ziua district, opposite Bonjour Residence, with an area of \u200B\u200B68 sqm, underfloor heating, 2 bedrooms, 2 balconies, used and furnished, 1/3 floor, elevator, outdoor parking. It has a surface of 68 square meters.The price is 690 euro. Number of rooms is 3. Located at floor 1/3. Additional keywords for this apartment are []. Description of provided images: null";
        var ap4 = "The apartment called \"2 pics\" is located in the city Cluj-Napoca, area or neighbourhood Marasti. It has a surface of 67 square meters.The price is 564 euro. Number of rooms is 3. Located at floor 2. Additional keywords for this apartment are []. Description of provided images: This modern kitchen features a large island with seating for four, complemented by elegant pendant lighting. The navy blue cabinets provide a striking contrast to the white countertops and backsplash. Open shelving adds a touch of contemporary style, while stainless steel appliances complete the sophisticated look. The spacious layout is perfect for both cooking and entertaining, creating a welcoming atmosphere in the heart of the home.This cozy bedroom features a plush, king-sized bed adorned with soft pillows and an elegant headboard. A sleek bench at the foot of the bed offers additional seating. The room is warmly lit by matching bedside lamps and natural light streaming through large French doors, which open to a serene view. Neutral tones and luxurious fabrics create a relaxing ambiance, making it a perfect retreat for rest and rejuvenation.";
        var ap5 = "The apartment called \"Studio Ultracentral\" is located in the city Cluj-Napoca, area or neighbourhood Ultracentral. The individual offers for rent a studio apartment located in the city center, in the Sora area. The apartment has an area of \u200B\u200B35 square meters, is fully equipped, has a TV, a washing machine and offers modern finishes. The location is pet-friendly, so pets are welcome.It has a surface of 35 square meters.The price is 550 euro. Number of rooms is 1. Located at floor Ground level. Additional keywords for this apartment are []. Description of provided images: Charming dining area with a cozy and inviting ambiance, featuring a white wooden dining table set for four. The space includes elegant lighting fixtures, a decorative fireplace, and tasteful wall art. Ideal for intimate gatherings, the room is complemented by warm wooden flooring and a compact kitchenette with essential amenities, including a coffee maker and ample storage. Perfect for enjoying meals and creating memorable moments.This charming dining area features a rustic wooden table set for four, surrounded by elegant white chairs. A cozy electric fireplace is mounted beneath a painting, creating a warm and inviting atmosphere. The room's ambiance is enhanced by unique decor elements, including a vintage-style shield and artwork on the walls. The kitchenette area is equipped with modern appliances, including a microwave and coffee maker, making it ideal for intimate gatherings and everyday dining.This charming studio apartment features a blend of rustic and modern design elements, complete with vaulted ceilings and elegant wood finishes. The open layout includes a cozy living area, a well-equipped kitchenette, and a quaint dining space. The room is brightened by natural light from the window, enhancing its welcoming ambiance. Ideal for singles or couples seeking a stylish and comfortable living space.This modern bathroom features a sleek walk-in shower with a stylish black frame and glass partition. The walls are adorned with beige tiles accented by decorative patterns, providing a warm and inviting atmosphere. A convenient shower shelf is included for toiletries. The wooden door complements the contemporary design, making this space both functional and aesthetically pleasing for any home.";
        var ap6 = "The apartment called \"1 room location Alee Detunata\" is located in the city Cluj-Napoca, area or neighbourhood Gheorgheni. Individuals offer for rent a 30 sqm studio apartment. completely renovated, for the first rental, in the Gheorgheni district, Aleea Detunata no. 9, et. 7, immediately available. The studio consists of a hall, kitchen, bathroom, open balcony and living room. Optionally there is a dryer where bikes, etc. can be stored.  New clothes washing machine. New refrigerator. New gas stove. New bed. New dressing.The studio is located in an excellent area, 5 min. from Iulius Mall, 3 min. by the Gheorgheni Sports Base adjacent to Mercur Park.There is no parking space, but you can park in the surroundings of the block.Restrictions: The studio is not pet friendly or for people who smoke in the house.It has a surface of 30 square meters.The price is 450 euro. Number of rooms is 1. Located at floor 7. Additional keywords for this apartment are []. Description of provided images: This modern living room features a sleek black sofa against a light neutral wall, complemented by a contemporary wooden door with frosted glass panels. A stylish round table with decorative placemats and a colorful floral chair add a touch of vibrancy. The room is well-lit by a chic geometric ceiling light, and the wood-look flooring adds warmth to the space, creating a welcoming atmosphere ideal for relaxation or entertaining guests.This modern kitchen features stylish blue cabinetry with elegant gold handles, complemented by a sleek stainless steel sink and contemporary gas stovetop. The light wood countertop offers ample space for meal preparation, while the textured tile backsplash adds a touch of sophistication. Perfect for those who appreciate both functionality and aesthetics in their culinary space.This modern bathroom features elegant marble-patterned tiles and a spacious walk-in shower with a sleek glass partition. The room includes a white vanity with ample storage, a large mirror, and contemporary fixtures. A washing machine is conveniently installed, making the space functional and efficient. The warm tones of the wood-look flooring add a touch of coziness to the clean, minimalist design.";
        var ap7 = "The apartment called \"Old 2 room apartment\" is located in the city Cluj-Napoca, area or neighbourhood Central. Available immediately. Max 2 people, or a small family Refrigerator, dishwasher, hood, stove, luxury kitchen, washing machine, tumble dryer, vacuum cleaner, internetDesk, 2x sofa bed, 2x wardrobe, chest of drawers, etc. fully furnishedIt has a surface of 47 square meters.The price is 500 euro. Number of rooms is 2. Located at floor 1. Additional keywords for this apartment are []. Description of provided images: null";
        var ap8 = "The apartment called \"3 room Apartment, 65 sqm, Citadela Residence\" is located in the city Cluj-Napoca, area or neighbourhood Citadela Residence. A 3-room apartment for rent in the Citadela residential district, away from busy roads, it is located near the forest, the apartment is furnished and equipped, the compartmentation is arranged as follows: living room with open-space kitchen, two bedrooms, one matrimonial and a bedroom for children, two bathrooms and a balcony, the apartment has its own heating plant and the latest generation appliances, dishwasher, electric pita, electric oven, washing machine and fridge with freezer, available from August 1.It has a surface of 65 square meters.The price is 500 euro. Number of rooms is 3. Located at floor 0/2. Additional keywords for this apartment are [students,, airbnb]. Description of provided images: null";

        StringBuilder sb = new StringBuilder("Given the list of apartments from below, answer the following request: " + message);
        sb.append("\n").append(ap1);
        sb.append("\n").append(ap2);
        sb.append("\n").append(ap3);
        sb.append("\n").append(ap4);
        sb.append("\n").append(ap5);
        sb.append("\n").append(ap6);
        sb.append("\n").append(ap7);
        sb.append("\n").append(ap8);

        return Map.of("generation", chatModel.call(sb.toString()));
    }
}
